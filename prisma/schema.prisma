generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider          = "postgresql"
  url               = env("DATABASE_URL")
}

model User {
  id            String    @id @default(uuid()) 
  email         String    @unique
  name          String?
  role          UserRole  @default(ADMIN)
  avatar_url    String?
  is_active     Boolean   @default(true)
  created_at    DateTime  @default(now())
  updated_at    DateTime  @updatedAt
  
  projects      Project[]
  services      Service[]
  portfolio_items PortfolioItem[]
  blog_posts    BlogPost[]
  testimonials  Testimonial[]
  
  @@map("users")
  TeamMember TeamMember[]
}

enum UserRole {
  ADMIN
  VIEWER
}

model Service {
  id            String    @id @default(uuid())
  name          String   
  slug          String    @unique
  description   String
  icon          String?
  short_desc    String?   
  image_url     String?  
  price_range   String?
  duration      String?
  features      Json
  technologies  Json
  is_featured   Boolean   @default(false)
  is_active     Boolean   @default(true)
  sort_order    Int       @default(0)
  created_by    String
  created_at    DateTime  @default(now())
  updated_at    DateTime  @updatedAt
  
  creator       User      @relation(fields: [created_by], references: [id])
  portfolio_items PortfolioItem[]
  inquiries     Inquiry[]
  
  @@map("services")
}

model PortfolioItem {
  id            String    @id @default(uuid())
  title         String
  slug          String    @unique
  description   String
  short_desc    String?
  client_name   String?
  project_url   String?
  github_url    String?
  image_url     String?
  gallery       Json?
  technologies  Json
  challenges    String?
  solutions     String?
  results       String?
  service_id    String
  is_featured   Boolean   @default(false)
  is_active     Boolean   @default(true)
  sort_order    Int       @default(0)
  created_by    String
  created_at    DateTime  @default(now())
  updated_at    DateTime  @updatedAt
  
  service       Service   @relation(fields: [service_id], references: [id])
  creator       User      @relation(fields: [created_by], references: [id])
  
  @@map("portfolio_items")
}

model Testimonial {
  id            String    @id @default(uuid())
  seed_identifier String    @unique
  client_name   String
  client_title  String?
  client_company String?
  client_email  String?
  client_photo  String?
  rating        Int       @default(5)
  content       String
  project_type  String?
  is_featured   Boolean   @default(false)
  is_active     Boolean   @default(true)
  is_verified   Boolean   @default(false)
  sort_order    Int       @default(0)
  created_by    String
  created_at    DateTime  @default(now())
  updated_at    DateTime  @updatedAt
  
  creator       User      @relation(fields: [created_by], references: [id])
  
  @@map("testimonials")
}

model BlogPost {
  id            String    @id @default(uuid())
  title         String
  slug          String    @unique
  content       String
  excerpt       String?
  featured_image String?
  meta_title    String?
  meta_description String?
  tags          Json?
  is_published  Boolean   @default(false)
  is_featured   Boolean   @default(false)
  read_time     Int?
  view_count    Int       @default(0)
  published_at  DateTime?
  created_by    String
  created_at    DateTime  @default(now())
  updated_at    DateTime  @updatedAt
  
  author        User      @relation(fields: [created_by], references: [id])
  
  @@map("blog_posts")
}


model Project {
  id               String    @id @default(uuid())
  seed_identifier  String    @unique // Unique identifier for seeding/upserting
  slug             String    @unique // URL-friendly unique identifier
  title            String
  description      String    // Detailed description for a project page
  short_description String?  // Brief description for listings/cards
  imageSrc         String    // Cloudinary URL for the main image
  altText          String
  category         String?   // e.g., "Web App", "Mobile App", "UI/UX"
  technologies     String[]  // List of technologies used, e.g., ["React", "Node.js"]
  client_name      String?   // Optional: Name of the client for this project
  project_url      String?   // Optional: Link to the live project
  github_url       String?   // Optional: Link to the GitHub repository

  is_featured      Boolean   @default(false) // For showcasing on the homepage
  is_active        Boolean   @default(true)  // To toggle visibility
  sort_order       Int?      // For manual ordering in lists

  created_at       DateTime  @default(now())
  updated_at       DateTime  @updatedAt

  // Relationship to User for RLS/permissions
  created_by       String?
  creator          User?     @relation(fields: [created_by], references: [id])

  @@index([slug]) // Add an index for faster lookups by slug
  @@index([is_active, is_featured]) // Add an index for filtering by active/featured status
}

model Inquiry {
  id            String    @id @default(uuid())
  name          String
  email         String
  phone         String?
  company       String?
  message       String
  service_id    String?
  budget_range  String?
  timeline      String?
  source        String?
  status        InquiryStatus @default(NEW)
  priority      InquiryPriority @default(MEDIUM)
  assigned_to   String?
  notes         String?
  created_at    DateTime  @default(now())
  updated_at    DateTime  @updatedAt
  
  service       Service?  @relation(fields: [service_id], references: [id])
  
  @@map("inquiries")
}

enum InquiryStatus {
  NEW
  IN_PROGRESS
  PROPOSAL_SENT
  CLOSED_WON
  CLOSED_LOST
}

enum InquiryPriority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

model TeamMember {
  id              String   @id @default(uuid())
  seed_identifier String   @unique // Unique identifier for seeding/upserting
  name            String
  role            String   // e.g., "Lead Developer", "UI/UX Designer"
  bio             String?  // Short biography or professional summary
  avatar_url      String?  // Cloudinary URL for profile picture
  social_links    Json?    // e.g., { "linkedin": "...", "twitter": "..." }

  is_active       Boolean  @default(true) // To toggle visibility
  sort_order      Int?     // For manual ordering in lists

  created_at      DateTime @default(now())
  updated_at      DateTime @updatedAt

  // Relationship to User for RLS/permissions (optional, but good for admin control)
  created_by      String?
  creator         User?    @relation(fields: [created_by], references: [id])

  @@index([is_active]) // Index for active status queries
}
